{% load static %}
{% load formatos %}
{% block extra_css %}
<link rel="stylesheet" href="{% static 'heladeria/css/pos_home.css' %}">
{% endblock %}
<div class="row g-4">
  {% for producto in productos %}
  <div class="col-6 col-sm-4 col-md-3">
    <div class="card shadow-sm border-0 h-100">

      {% if producto.imagen %}
        <img src="{{ producto.imagen.url }}" class="card-img-top" alt="{{ producto.nombre|escape }}" style="height:150px; object-fit:cover;">
      {% else %}
        <div class="bg-secondary d-flex align-items-center justify-content-center" style="height:150px;">
          <span class="text-white">Sin imagen</span>
        </div>
      {% endif %}

      <div class="card-body d-flex flex-column">
        <h6 class="card-title mb-1 text-truncate" title="{{ producto.nombre|escape }}">
          {{ producto.nombre }}
        </h6>

        <p class="mb-2 text-primary fw-bold">${{ producto.precio|precio_cl }}</p>

        <div class="d-flex justify-content-center align-items-center mb-2">
          <div class="input-group input-group-sm" style="width:120px;">
            <button class="btn btn-outline-secondary btn-decr" type="button" data-target="#cantidad-{{ producto.id }}">−</button>

            <input id="cantidad-{{ producto.id }}"
              type="text"
              class="form-control text-center cantidad-input"
              value="1"
              inputmode="numeric"
              pattern="[0-9]*"
              maxlength="2">

            <button class="btn btn-outline-secondary btn-incr" type="button" data-target="#cantidad-{{ producto.id }}">+</button>
          </div>
        </div>

        <button
          type="button"
          class="btn btn-success btn-sm mt-auto add-btn"
          data-id="{{ producto.id }}"
          data-name="{{ producto.nombre|escape }}"
          data-price="{{ producto.precio|precio_cl }}">
          Agregar
        </button>
      </div>

    </div>
  </div>
  {% empty %}
    <p class="text-muted">No se encontraron productos.</p>
  {% endfor %}
</div>
{% if page_obj.has_other_pages %}
<div class="table-footer" 
     style="display:flex; justify-content:space-between; align-items:center; gap:1rem; margin-top:1rem;">

    <!-- LEFT: resultados -->
    <div class="results-per-page">
        <span>Mostrando {{ page_obj.start_index }}–{{ page_obj.end_index }} de {{ page_obj.paginator.count }}</span>
    </div>

    <!-- RIGHT: paginación -->
    <div class="pagination" style="display:flex; gap:4px; align-items:center;">

        <!-- FIRST -->
        <button class="pagination-btn"
                {% if page_obj.has_previous %}
                    data-page="1"
                {% else %} disabled {% endif %}>
            ««
        </button>

        <!-- PREV -->
        <button class="pagination-btn"
                {% if page_obj.has_previous %}
                    data-page="{{ page_obj.previous_page_number }}"
                {% else %} disabled {% endif %}>
            «
        </button>

        <!-- current page -->
        <span class="pagination-info" 
              style="padding:6px 10px; border:1px solid #ccc; border-radius:6px;">
            Página {{ page_obj.number }} / {{ page_obj.paginator.num_pages }}
        </span>

        <!-- NEXT -->
        <button class="pagination-btn"
                {% if page_obj.has_next %}
                    data-page="{{ page_obj.next_page_number }}"
                {% else %} disabled {% endif %}>
            »
        </button>

        <!-- LAST -->
        <button class="pagination-btn"
                {% if page_obj.has_next %}
                    data-page="{{ page_obj.paginator.num_pages }}"
                {% else %} disabled {% endif %}>
            »»
        </button>

    </div>

</div>
{% endif %}
